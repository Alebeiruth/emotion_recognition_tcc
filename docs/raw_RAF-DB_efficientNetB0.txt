
================================================================================
AN√ÅLISE DETALHADA - DADOS DESBALANCEADOS
================================================================================
DISTRIBUI√á√ÉO DE CLASSES:
  ‚Ä¢ Raiva: 162 amostras (5.3%)
  ‚Ä¢ Nojo: 160 amostras (5.2%)
  ‚Ä¢ Medo: 74 amostras (2.4%)
  ‚Ä¢ Felicidade: 1185 amostras (38.6%)
  ‚Ä¢ Neutro: 680 amostras (22.2%)
  ‚Ä¢ Tristeza: 478 amostras (15.6%)
  ‚Ä¢ Surpresa: 329 amostras (10.7%)

ESTAT√çSTICAS DE DESBALANCEAMENTO:
  ‚Ä¢ Ratio m√°ximo/m√≠nimo: 16.01x
  ‚Ä¢ Desvio padr√£o: 361.7 amostras
  ‚Ä¢ Coeficiente de varia√ß√£o: 0.825
  ‚Ä¢ Classe majorit√°ria: Felicidade (1185 amostras)
  ‚Ä¢ Classe minorit√°ria: Medo (74 amostras)

IMPACTO NA PERFORMANCE:
  ‚Ä¢ Correla√ß√£o amostras-F1: 0.807
    ‚Üí FORTE correla√ß√£o positiva: mais amostras = melhor F1
  ‚Ä¢ Melhor F1: Felicidade (0.864) - 1185.0 amostras
  ‚Ä¢ Pior F1: Nojo (0.362) - 160.0 amostras

MAIORES CONFUS√ïES:
  ‚Ä¢ Nojo ‚Üí Neutro: 0.219
  ‚Ä¢ Nojo ‚Üí Neutro: 0.219
  ‚Ä¢ Surpresa ‚Üí Neutro: 0.158
  ‚Ä¢ Tristeza ‚Üí Neutro: 0.157

RECOMENDA√á√ïES:
  ‚Ä¢ Desbalanceamento SEVERO - considere t√©cnicas de balanceamento
  ‚Ä¢ Sugest√µes: SMOTE, class weighting, focal loss
  ‚Ä¢ Considere estrat√©gias para classes minorit√°rias
================================================================================
Model saved: models/efficientnet/efficientnet_model_efficientnet_pytorch_emotion_20250929_193832.pth
Metrics saved: metrics/efficientnet/efficientnet_metrics_efficientnet_pytorch_emotion_20250929_193832.csv

======================================================================
EFFICIENTNET-B0 MONITORING REPORT
======================================================================
Total training time: 0:23:58
  ‚Ä¢ Phase 1 (Base layers): 0:07:05
  ‚Ä¢ Phase 2 (Fine-tuning): 0:16:41
Initial memory: 2271.64 MB
Final memory: 6032.04 MB
Peak memory: 6021.00 MB
Memory efficiency: 0.377
Growth factor: 2.65x
======================================================================

============================================================
EXPERIMENT COMPLETED SUCCESSFULLY
============================================================
Experiment ID: efficientnet_pytorch_emotion_20250929_193832
Files generated:
  ‚Ä¢ Visualizations: plots/efficientnet/efficientnet_comprehensive_analysis_pytorch_efficientnet_pytorch_emotion_20250929_193832.png
  ‚Ä¢ Metrics: metrics/efficientnet/efficientnet_metrics_efficientnet_pytorch_emotion_20250929_193832.csv
  ‚Ä¢ Model: models/efficientnet/efficientnet_model_efficientnet_pytorch_emotion_20250929_193832.pth
  ‚Ä¢ Best model: best_efficientnet_model.pth

IMBALANCE ANALYSIS SUMMARY:
  ‚Ä¢ Test set imbalance ratio: 16.0:1
  ‚Ä¢ Macro F1 (unweighted): 0.6359
  ‚Ä¢ Weighted F1 (balanced): 0.7350
  ‚Ä¢ Performance difference: 0.0991
  ‚Üí Model benefits significantly from class weighting


  Starting EfficientNet-B0 training...
Start time: 2025-09-29 19:38:32
Initial memory: 2271.64 MB
Device: cuda
--------------------------------------------------
Experiment ID: efficientnet_pytorch_emotion_20250929_193832
Loading data...
Loading preprocessed JPG data for EfficientNet...
Loading TRAIN from: ../data/raw/RAF-DB/DATASET/train
üìÅ Subdirectories found: ['Tristeza', 'Raiva', 'Neutro', 'Surpresa', 'Felicidade', 'Medo', 'Nojo']
  üì∏ Raiva: 705 files found
  ‚úÖ Raiva: 705 images loaded successfully
  üì∏ Nojo: 717 files found
  ‚úÖ Nojo: 717 images loaded successfully
  üì∏ Medo: 281 files found
  ‚úÖ Medo: 281 images loaded successfully
  üì∏ Felicidade: 4772 files found
  ‚úÖ Felicidade: 4772 images loaded successfully
  üì∏ Neutro: 2524 files found
  ‚úÖ Neutro: 2524 images loaded successfully
  üì∏ Tristeza: 1982 files found
  ‚úÖ Tristeza: 1982 images loaded successfully
  üì∏ Surpresa: 1290 files found
  ‚úÖ Surpresa: 1290 images loaded successfully
Loading TEST from: ../data/raw/RAF-DB/DATASET/test
üìÅ Subdirectories found: ['Tristeza', 'Raiva', 'Neutro', 'Surpresa', 'Felicidade', 'Medo', 'Nojo']
  üì∏ Raiva: 162 files found
  ‚úÖ Raiva: 162 images loaded successfully
  üì∏ Nojo: 160 files found
  ‚úÖ Nojo: 160 images loaded successfully
  üì∏ Medo: 74 files found
  ‚úÖ Medo: 74 images loaded successfully
  üì∏ Felicidade: 1185 files found
  ‚úÖ Felicidade: 1185 images loaded successfully
  üì∏ Neutro: 680 files found
  ‚úÖ Neutro: 680 images loaded successfully
  üì∏ Tristeza: 478 files found
  ‚úÖ Tristeza: 478 images loaded successfully
  üì∏ Surpresa: 329 files found
  ‚úÖ Surpresa: 329 images loaded successfully

üìä Data loaded successfully:
- X_train: (12271, 224, 224, 3)
- y_train: (12271,)
- X_test: (3068, 224, 224, 3)
- y_test: (3068,)

üîç Final verification:
- X_train range: [0.000, 255.000]
- X_test range: [0.000, 255.000]
- Image format: (224, 224, 3) (should be 224x224x3)
Data split:
  ‚Ä¢ Train: (8589, 224, 224, 3)
  ‚Ä¢ Validation: (3682, 224, 224, 3)
  ‚Ä¢ Test: (3068, 224, 224, 3)

Data distribution analysis:
Training set:
  ‚Ä¢ Raiva: 493 samples
  ‚Ä¢ Nojo: 502 samples
  ‚Ä¢ Medo: 197 samples
  ‚Ä¢ Felicidade: 3340 samples
  ‚Ä¢ Neutro: 1767 samples
  ‚Ä¢ Tristeza: 1387 samples
  ‚Ä¢ Surpresa: 903 samples
Test set:
  ‚Ä¢ Raiva: 162 samples
  ‚Ä¢ Nojo: 160 samples
  ‚Ä¢ Medo: 74 samples
  ‚Ä¢ Felicidade: 1185 samples
  ‚Ä¢ Neutro: 680 samples
  ‚Ä¢ Tristeza: 478 samples
  ‚Ä¢ Surpresa: 329 samples
Test set imbalance ratio: 16.0:1

Creating EfficientNet-B0 model...
EfficientNet-B0 created successfully:
  ‚Ä¢ Total parameters: 5,847,683
  ‚Ä¢ Trainable parameters: 5,847,683
  ‚Ä¢ Efficiency: 5.8M parameters
  ‚Ä¢ Trainable ratio: 100.0%
  ‚Ä¢ Initial GPU memory: 22.5 MB

============================================================
STARTING TRAINING
============================================================
============================================================
STARTING EFFICIENTNET 2-PHASE TRAINING
============================================================
PHASE 1: FEATURE EXTRACTION
----------------------------------------
Starting phase1 - EfficientNet
Epoch 1, Batch 0/269, Loss: 2.1964, Acc: 18.75%
Epoch 70, Batch 250/269, Loss: 0.3992, Acc: 86.02%
phase2 completed in: 0:16:41
Phase 2 - Best val_accuracy: 72.7594

TRAINING COMPLETE:
  ‚Ä¢ Total epochs: 100
  ‚Ä¢ Best final accuracy: 72.7594
  ‚Ä¢ Total time: 0:23:47
Loaded best model weights for evaluation
Peak GPU memory: 415.0 MB

============================================================
CREATING COMPREHENSIVE ANALYSIS
============================================================
Measuring inference performance...

COMPREHENSIVE RESULTS:
  ‚Ä¢ Test Accuracy: 0.7324 (73.24%)
  ‚Ä¢ F1-Score (Macro): 0.6359
  ‚Ä¢ F1-Score (Weighted): 0.7350
  ‚Ä¢ Precision (Macro): 0.6544
  ‚Ä¢ Recall (Macro): 0.6262
  ‚Ä¢ Inference Speed: 2849.3 samples/second
  ‚Ä¢ Total Training Time: 0:23:47

Generating comprehensive visualizations...